import{n as s,u as r,r as e,j as a,G as o,T as n,A as i,F as d,c as t,S as l,I as w,O as c,a as m,B as u,C as h,f as P,_ as f,m as x}from"./index-DyR0ftVW.js";function j(){const[j]=s(),v=r(),p=j.get("token"),g=j.get("email"),[b,y]=e.useState(""),[S,B]=e.useState("");e.useEffect(()=>{p||B("Invalid or missing token.")},[p]);return a.jsx(o,{container:!0,justifyContent:"center",spacing:2,sx:{mt:8},children:a.jsxs(o,{item:!0,xs:11,sm:6,md:4,children:[a.jsx(n,{variant:"h4",gutterBottom:!0,children:"Reset Your Password"}),a.jsx(n,{variant:"body2",sx:{mb:3},children:"Enter your new password below."}),S&&a.jsx(i,{severity:"error",sx:{mb:2},children:S}),b&&a.jsx(i,{severity:"success",sx:{mb:2},children:b}),a.jsx(d,{initialValues:{newPassword:"",confirmPassword:""},validationSchema:t().shape({newPassword:P().min(6,"Password must be at least 6 characters").max(50,"Password must be less than 50 characters").required("New Password is required"),confirmPassword:P().required("Confirm Password is required").oneOf([f("newPassword")],"Passwords must match")}),onSubmit:async(s,{setSubmitting:r})=>{var e,a,o;y(""),B("");try{const r=await x.post("https://healthco.clinic/api/api/account/reset-password",{email:g,token:p,newPassword:s.newPassword,confirmPassword:s.confirmPassword});"string"==typeof r.data&&200===r.status?(y(r.data),setTimeout(()=>v("/login"),2e3)):(null==(e=r.data)?void 0:e.value)?(y(r.data.value),setTimeout(()=>v("/login"),2e3)):B("Failed to reset password.")}catch(n){const s=null==(a=n.response)?void 0:a.data;B((null==s?void 0:s.detail)||(null==(o=null==s?void 0:s.value)?void 0:o.message)||"Server error. Please try again.")}r(!1)},children:({errors:s,handleBlur:r,handleChange:e,handleSubmit:o,touched:n,values:i,isSubmitting:d})=>a.jsx("form",{noValidate:!0,onSubmit:o,children:a.jsxs(l,{spacing:2,children:[a.jsxs("div",{children:[a.jsx(w,{htmlFor:"newPassword",children:"New Password"}),a.jsx(c,{fullWidth:!0,id:"newPassword",name:"newPassword",type:"password",value:i.newPassword,onChange:e,onBlur:r,error:Boolean(n.newPassword&&s.newPassword)}),n.newPassword&&s.newPassword&&a.jsx(m,{error:!0,children:s.newPassword})]}),a.jsxs("div",{children:[a.jsx(w,{htmlFor:"confirmPassword",children:"Confirm Password"}),a.jsx(c,{fullWidth:!0,id:"confirmPassword",name:"confirmPassword",type:"password",value:i.confirmPassword,onChange:e,onBlur:r,error:Boolean(n.confirmPassword&&s.confirmPassword)}),n.confirmPassword&&s.confirmPassword&&a.jsx(m,{error:!0,children:s.confirmPassword})]}),a.jsx(u,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,disabled:d||!p,children:d?a.jsx(h,{size:22}):"Reset Password"})]})})})]})})}export{j as default};
