import{j as e,an as i,ao as a,S as t,p as n,T as s,aj as o,P as r,r as c,ap as d,al as l,aq as f,ar as u,as as p,at as m,au as g,y as x}from"./index-DyR0ftVW.js";import{M as h}from"./ManagementHeader-ym6m9w7H.js";import{u as b}from"./useClinicSync-pPWROp7F.js";const y=({feature:r,enabled:c,onToggle:d,disabled:l=!1})=>{const f=r.icon,u=r.comingSoon||!1;return e.jsx(i,{sx:{borderRadius:"12px",transition:"all 0.2s ease-in-out",border:u?"2px solid #94a3b8":c?"2px solid #3b82f6":"2px solid #e2e8f0",backgroundColor:u?"#f8fafc":c?"#f0f9ff":"#ffffff",opacity:u?.85:1,"&:hover":{boxShadow:u?"0 4px 12px rgba(148, 163, 184, 0.15)":c?"0 8px 24px rgba(59, 130, 246, 0.15)":"0 4px 12px rgba(0, 0, 0, 0.08)",transform:"translateY(-2px)"}},children:e.jsx(a,{sx:{p:3},children:e.jsxs(t,{spacing:2,children:[e.jsxs(t,{direction:"row",alignItems:"flex-start",justifyContent:"space-between",spacing:2,children:[e.jsxs(t,{direction:"row",alignItems:"center",spacing:1.5,children:[e.jsx(n,{sx:{width:40,height:40,borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:u?"#94a3b8":c?"#3b82f6":"#e2e8f0",color:u||c?"#ffffff":"#64748b",transition:"all 0.2s ease"},children:f&&e.jsx(f,{size:22})}),e.jsx(s,{variant:"h6",sx:{fontWeight:600,color:u?"#475569":c?"#1e40af":"#334155",fontSize:"1rem"},children:r.name})]}),e.jsx(o,{checked:c,onChange:e=>{l||u||!d||d(r.id,e.target.checked)},disabled:l||u,sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#3b82f6"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#3b82f6"}}})]}),e.jsx(s,{variant:"body2",sx:{color:"#64748b",fontSize:"0.875rem",lineHeight:1.6},children:r.description}),e.jsx(n,{children:e.jsx(s,{variant:"caption",sx:{display:"inline-block",px:1.5,py:.5,borderRadius:"6px",fontWeight:600,fontSize:"0.75rem",backgroundColor:u?"#e2e8f0":c?"#dbeafe":"#f1f5f9",color:u?"#475569":c?"#1e40af":"#64748b"},children:u?"Coming Soon":c?"Active":"Inactive"})})]})})})};y.propTypes={feature:r.shape({id:r.string.isRequired,name:r.string.isRequired,description:r.string.isRequired,icon:r.elementType,comingSoon:r.bool}).isRequired,enabled:r.bool.isRequired,onToggle:r.func,disabled:r.bool};const j=[{id:"core-platform",name:"Core Platform",description:"Essential appointment booking and management system. This feature cannot be disabled.",icon:f,alwaysActive:!0},{id:"email-service",name:"Email Service",description:"Send automated email notifications and reminders to patients and staff.",icon:u,alwaysActive:!1},{id:"sms-service",name:"SMS Service",description:"Send SMS notifications for appointment confirmations, reminders, and updates.",icon:p,alwaysActive:!1},{id:"ai-voice-agent",name:"AI Voice Agent",description:"Intelligent voice assistant for automated patient calls and appointment scheduling.",icon:m,alwaysActive:!1,comingSoon:!0},{id:"document-ai",name:"Document AI",description:"AI-powered document processing and intelligent data extraction from medical records.",icon:g,alwaysActive:!1,comingSoon:!0}],S=()=>{const{selectedClinicId:i,clinicList:a,loadingClinics:t,clinicError:o}=b(),{features:r,isLoading:f,refetch:u}=(e=>{const[i,a]=c.useState([]),[t,n]=c.useState(!1),[s,o]=c.useState(null),r=c.useCallback(async(i=!1)=>{if(e){i||n(!0),o(null);try{const i=await d.getClinicFeatures(e);a(i)}catch(t){o(t.message),a([])}finally{i||n(!1)}}else a([])},[e]);return c.useEffect(()=>{r()},[r]),{features:i,isLoading:t,error:s,refetch:r}})(i),{updateFeature:p}=(()=>{const[e,i]=c.useState(!1),[a,t]=c.useState(null);return{updateFeature:c.useCallback(async(e,a,n)=>{i(!0),t(null);try{return{success:!0,data:await d.updateClinicFeature(e,a,n)}}catch(s){return t(s.message),{success:!1,error:s.message}}finally{i(!1)}},[]),isLoading:e,error:a}})(),[m,g]=c.useState({});c.useEffect(()=>{if(r){const e=(r||[]).reduce((e,i)=>(e[i.featureKey]=i.isEnabled,e),{});g(e)}},[r]);const S=async(e,t)=>{if(!i)return;const n=j.find(i=>i.id===e),s=a.find(e=>e.clinicId===i||e.id===i);g(i=>({...i,[e]:t}));try{const a=await p(i,e,t);a.success?(await u(!0),x.success(`${n.name} has been ${t?"activated":"deactivated"} for ${(null==s?void 0:s.clinicName)||"clinic"}`,{position:"bottom-left",autoClose:2e3})):(g(i=>({...i,[e]:!t})),x.error(`Failed to update ${n.name}: ${a.error}`,{position:"bottom-left",autoClose:4e3}))}catch(o){g(i=>({...i,[e]:!t})),x.error(`Error updating ${n.name}. Please try again.`,{position:"bottom-left",autoClose:4e3})}};return e.jsxs(n,{children:[e.jsx(h,{icon:l.AccessControl,title:"Access Control",description:"Manage platform features and access permissions for each clinic",clinics:a,selectedClinicId:i,hideAddButton:!0,loadingClinics:t,clinicError:o}),i?e.jsx(n,{children:f&&0===Object.keys(m).length?e.jsx(n,{sx:{textAlign:"center",py:4},children:e.jsx(s,{variant:"body1",color:"textSecondary",children:"Loading features..."})}):e.jsx(e.Fragment,{children:e.jsx(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},gap:3},children:j.map(i=>e.jsx(y,{feature:i,enabled:m[i.id]||!1,onToggle:S,disabled:i.alwaysActive},i.id))})})}):e.jsxs(n,{sx:{textAlign:"center",py:8,px:2},children:[e.jsx(n,{sx:{width:80,height:80,borderRadius:"50%",backgroundColor:"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto",mb:3},children:e.jsx(l.AccessControl,{size:40,color:"#64748b"})}),e.jsx(s,{variant:"h5",sx:{fontWeight:600,color:"#334155",mb:1},children:"Select a Clinic to Manage Features"}),e.jsx(s,{variant:"body2",sx:{color:"#64748b",maxWidth:500,margin:"0 auto"},children:"Choose a clinic from the dropdown above to view and manage their platform feature access. You can activate or deactivate features based on their subscription package."})]})]})};export{S as default};
